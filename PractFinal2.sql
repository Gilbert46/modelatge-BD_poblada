-- MySQL Script generated by MySQL Workbench
-- Mon Jun 29 15:39:10 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
-- -----------------------------------------------------
-- Schema optica
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `optica` ;

-- -----------------------------------------------------
-- Schema optica
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `optica` DEFAULT CHARACTER SET utf8 ;
USE `optica` ;

-- -----------------------------------------------------
-- Table `optica`.`clients`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `optica`.`clients` ;

CREATE TABLE IF NOT EXISTS `optica`.`clients` (
  `id_client` INT UNSIGNED NOT NULL,
  `nom` VARCHAR(45) NOT NULL,
  `cp` INT(10) UNSIGNED ZEROFILL NULL DEFAULT NULL,
  `email` VARCHAR(45) NOT NULL,
  `telefon` INT UNSIGNED NULL DEFAULT NULL,
  `entrada` ENUM('anuncis', 'conegut', 'internet') NOT NULL,
  PRIMARY KEY (`id_client`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `optica`.`proveidor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `optica`.`proveidor` ;

CREATE TABLE IF NOT EXISTS `optica`.`proveidor` (
  `nif` INT UNSIGNED NOT NULL,
  `nom` VARCHAR(45) NOT NULL,
  `carrer` VARCHAR(45) NOT NULL,
  `numero` INT UNSIGNED NOT NULL,
  `pis` INT UNSIGNED NOT NULL,
  `porta` INT UNSIGNED NOT NULL,
  `ciutat` VARCHAR(45) NOT NULL,
  `cp` INT(10) UNSIGNED ZEROFILL NOT NULL,
  `pais` VARCHAR(45) NOT NULL,
  `telefon` INT UNSIGNED NOT NULL,
  `fax` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`nif`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `optica`.`marca`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `optica`.`marca` ;

CREATE TABLE IF NOT EXISTS `optica`.`marca` (
  `nom` VARCHAR(45) NOT NULL,
  `proveidor` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`nom`),
  INDEX `foranaproveidor` (`proveidor` ASC) VISIBLE,
  CONSTRAINT `foranaproveidor`
    FOREIGN KEY (`proveidor`)
    REFERENCES `optica`.`proveidor` (`nif`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `optica`.`ulleres`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `optica`.`ulleres` ;

CREATE TABLE IF NOT EXISTS `optica`.`ulleres` (
  `model` VARCHAR(45) NOT NULL,
  `marca` VARCHAR(45) NOT NULL,
  `graduacio` FLOAT UNSIGNED NOT NULL,
  `montura` ENUM('flotant', 'pasta', 'metalica') NOT NULL,
  `color` ENUM('negres', 'blanques', 'marrons') NOT NULL,
  `vidreDret` ENUM('transparent', 'opac') NOT NULL,
  `vidreEsquerra` ENUM('transparent', 'opac') NOT NULL,
  `preu` FLOAT UNSIGNED NOT NULL,
  PRIMARY KEY (`model`),
  INDEX `foranamarca` (`marca` ASC) VISIBLE,
  CONSTRAINT `foranamarca`
    FOREIGN KEY (`marca`)
    REFERENCES `optica`.`marca` (`nom`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `optica`.`venta`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `optica`.`venta` ;

CREATE TABLE IF NOT EXISTS `optica`.`venta` (
  `id_venta` INT UNSIGNED NOT NULL,
  `ulleres` VARCHAR(45) NOT NULL,
  `client_id` INT UNSIGNED NOT NULL,
  `empleat` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_venta`),
  INDEX `foranaulleres` (`ulleres` ASC) VISIBLE,
  INDEX `foranaclient` (`client_id` ASC) VISIBLE,
  CONSTRAINT `foranaclient`
    FOREIGN KEY (`client_id`)
    REFERENCES `optica`.`clients` (`id_client`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `foranaulleres`
    FOREIGN KEY (`ulleres`)
    REFERENCES `optica`.`ulleres` (`model`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

INSERT INTO clients VALUES
	(1, 'Albert Pla', 8034, 'albertpla67@gmail.com', '934562355', 'conegut'),
    (2, 'Joan Garrido', 8123, 'joangaridos@gmail.com', '934566333', 'internet'),
    (3, 'Carles Cardus', 8024, 'carlescadrs@gmail.com', '932554871', 'internet'),
    (4, 'Pere Montaneer', 8455, 'peremontaer@gmail.com', '931234528', 'anuncis'),
    (5, 'Mireia Capdevila', 9547, 'mireiacapde@gmail.com', '938653442', 'conegut'),
    (6, 'Pep Agull√≥', 9342, 'pepagulls@gmail.com', '939674322', 'anuncis'),
    (7, 'Laura Prats', 8004, 'lauraprats21@gmail.com', '913543433', 'internet'),
    (8, 'Roger Caubet', 8045, 'rogerddttfs@gmail.com', '933543321', 'conegut'),
    (9, 'Mireia Mas', 8011, 'mireiamas21@gmail.com', '931234546', 'internet');
SELECT * FROM clients;

INSERT INTO proveidor VALUES
	(11122233, 'Ramon Ubach', 'Gran Via de les Corts', 254, 5, 3, 'Barcelona', 8032, 'Espanya', 938877444, 930002323),
    (22233444, 'Josep Maria Folch', 'Trabesera de dalt', 345, 2, 1, 'Barcelona', 8045, 'Espanya', 931122333, 931112233),
    (33344555, 'Pere Sunyer', 'Carlos de Astruias', 176, 1, 1, 'Valencia', 9334, 'Espanya', 917777777, 912222222),
    (44431111, 'Inaki Satres', 'Republica ibera', 34, 1, 3, 'Bilbao', 9056, 'Espanya', 874444444, 875555555);
SELECT * FROM proveidor;

INSERT INTO marca VALUES
	('raiban', 11122233),
    ('Tous', 33344555),
    ('Dior', 44431111);
SELECT * FROM marca;

INSERT INTO ulleres VALUES
	('Ra6547', 'Raiban', 0.5, 'metalica', 'negres', 'opac', 'opac', 176.5),
    ('Ra63', 'Raiban', 1, 'metalica', 'marrons', 'transparent', 'transparent', 91.5),
    ('T45', 'Tous', 1.25, 'flotant', 'blanques',  'transparent', 'transparent', 211.5),
    ('T-88', 'Tous', 0.75, 'pasta', 'negres',  'transparent', 'transparent', 111.5),
    ('D123', 'Dior', 1.25, 'pasta', 'marrons', 'transparent', 'transparent', 81.5),
    ('Di-11', 'Dior', 1.05, 'flotant', 'blanques', 'transparent', 'transparent', 78.5);
SELECT * FROM ulleres;

INSERT INTO venta VALUES
	(1, 'T-88', 2, 'Robert'),
    (2, 'D123', 5, 'Anna'),
    (3, 'Ra6547', 6, 'Anna'),
    (4, 'T45', 7, 'Robert'),
    (5, 'D123', 8, 'Pep'),
    (6, 'Ra63', 9, 'Anna');
SELECT * FROM venta;

